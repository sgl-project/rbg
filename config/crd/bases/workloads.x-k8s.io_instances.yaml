---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.17.2
  name: instances.workloads.x-k8s.io
spec:
  group: workloads.x-k8s.io
  names:
    kind: Instance
    listKind: InstanceList
    plural: instances
    shortNames:
    - ins
    singular: instance
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - description: Overall readiness status
      jsonPath: .status.conditions[?(@.type=='InstanceReady')].status
      name: READY
      type: string
    - description: CreationTimestamp is a timestamp representing the server time when
        this object was created. It is not guaranteed to be set in happens-before
        order across separate operations. Clients may not set this value. It is represented
        in RFC3339 form and is in UTC.
      jsonPath: .metadata.creationTimestamp
      name: AGE
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: Instance is the Schema for the instances API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
            type: string
          metadata:
            type: object
          spec:
            description: InstanceSpec defines the desired state ofInstance
            properties:
              components:
                description: Components is a list of components, each of which specifies
                  a component and the number of replicas and template for Instance
                  that match the component.
                items:
                  properties:
                    name:
                      description: Name is the type name of the component.
                      type: string
                    serviceName:
                      description: |-
                        serviceName is the name of the service that governs this Instance Component.
                        This service must exist before the Instance, and is responsible for
                        the network identity of the set.
                      type: string
                    size:
                      description: Size is the number of replicas for Pods that match
                        the PodRule.
                      format: int32
                      type: integer
                    template:
                      description: Template is the template for the component pods.
                      x-kubernetes-preserve-unknown-fields: true
                  required:
                  - name
                  - template
                  type: object
                type: array
              podGroupPolicy:
                description: MinReadySeconds is the minimum number of seconds for
                  which a newly created Pod should be ready without any of its containers
                  crashing, for it to be considered available.
                properties:
                  kubeScheduling:
                    description: KubeScheduling plugin from the Kubernetes scheduler-plugins
                      for gang-scheduling.
                    properties:
                      scheduleTimeoutSeconds:
                        default: 60
                        description: |-
                          Time threshold to schedule PodGroup for gang-scheduling.
                          If the scheduling timeout is equal to 0, the default value is used.
                          Defaults to 60 seconds.
                        format: int32
                        type: integer
                    type: object
                  volcanoScheduling:
                    description: VolcanoSchedulingPodGroupPolicySource represents
                      configuration for volcano podgroup scheduling plugin
                    properties:
                      priorityClassName:
                        description: If specified, indicates the PodGroup's priority.
                        type: string
                      queue:
                        description: |-
                          Queue defines the queue to allocate resource for PodGroup; if queue does not exist,
                          the PodGroup will not be scheduled. Defaults to `default` Queue with the lowest weight.
                        type: string
                    type: object
                type: object
              readinessGates:
                description: ReadinessGates is an optional list of PodReadinessGates
                  for the whole Instance.
                items:
                  description: InstanceReadinessGate contains the reference to a Instance
                    condition
                  properties:
                    conditionType:
                      description: ConditionType refers to a condition in the pod's
                        condition list with matching type.
                      type: string
                  required:
                  - conditionType
                  type: object
                type: array
              readyPolicy:
                default: AllPodReady
                description: |-
                  InstanceReadyPolicy specifies the policy for determining if the Instance is ready.
                  Defaults to `AllPodReady`
                type: string
              restartPolicy:
                description: RestartPolicy defines the restart policy for all pods
                  within the Instance.
                type: string
            required:
            - components
            type: object
          status:
            description: InstanceStatus defines the observed state ofInstance
            properties:
              collisionCount:
                description: CollisionCount is the count of hash collisions for the
                  InstanceSet.
                format: int32
                type: integer
              componentStatuses:
                description: ComponentStatuses is a list of ComponentStatus, each
                  of which specifies the status of a component.
                items:
                  properties:
                    availableReplicas:
                      description: AvailableReplicas is the number of available Pod
                        for Instance that match the component.
                      format: int32
                      type: integer
                    name:
                      description: Name is the type name of the component.
                      type: string
                    readyReplicas:
                      description: ReadyReplicas is the number of ready Pod for Instance
                        that match the component.
                      format: int32
                      type: integer
                    replicas:
                      description: Size is the number of Pod for Instance that match
                        the component.
                      format: int32
                      type: integer
                    scheduledReplicas:
                      description: ScheduledReplicas is the number of scheduled Pod
                        for Instance that match the component.
                      format: int32
                      type: integer
                    updatedReadyReplicas:
                      description: UpdatedReadyReplicas is the number of updated and
                        ready Pod for Instance that match the component.
                      format: int32
                      type: integer
                    updatedReplicas:
                      description: UpdatedReplicas is the number of updated Pod for
                        Instance that match the component.
                      format: int32
                      type: integer
                  required:
                  - availableReplicas
                  - name
                  - readyReplicas
                  - replicas
                  - scheduledReplicas
                  - updatedReadyReplicas
                  - updatedReplicas
                  type: object
                type: array
              conditions:
                description: Conditions track the condition of the Instance
                items:
                  description: InstanceCondition describes the state of a Instance
                    at a certain point.
                  properties:
                    lastTransitionTime:
                      description: Last time the condition transitioned from one status
                        to another.
                      format: date-time
                      type: string
                    message:
                      description: A human readable message indicating details about
                        the transition.
                      type: string
                    reason:
                      description: The reason for the condition's last transition.
                      type: string
                    status:
                      description: Status of the condition, one of True, False, Unknown.
                      type: string
                    type:
                      description: Type of Instance condition.
                      type: string
                  required:
                  - status
                  - type
                  type: object
                type: array
              currentRevision:
                description: CurrentRevision is a hash value that changes when the
                  spec is changed.
                type: string
              labelSelector:
                description: LabelSelector of an Instance is a label query over Pods
                  that should match the Instance.
                type: string
              observedGeneration:
                description: |-
                  ObservedGeneration is the most recent generation observed for this Instance. It corresponds to the
                  Instance's generation, which is updated on mutation by the API Server.
                format: int64
                type: integer
              updateRevision:
                description: UpdateRevision is a hash value that changes when the
                  spec is changed.
                type: string
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
